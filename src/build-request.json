{
  "kind": "build_request",
  "title": "Add raw.icp0.io HTTP GET /status endpoint for canister health/status",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Implement the Internet Computer HTTP interface on the backend canister by exporting a public query `http_request` function that can be called via `https://<CANISTER_ID>.raw.icp0.io/...`, and route requests by URL path.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-4",
          "msg-7",
          "msg-11"
        ],
        "quotes": [
          "yes add one of the http endpoints now",
          "2. let's do simple /status",
          "we just want to return the status of the canister"
        ]
      },
      "acceptanceCriteria": [
        "Backend canister exports a public query method named `http_request` that is callable through the raw.icp0.io HTTP gateway (no longer returns 503/method-not-found for implemented routes).",
        "`http_request` inspects the incoming HTTP request URL/path and dispatches to the correct handler.",
        "Responses include `Content-Type: application/json; charset=utf-8` and include permissive CORS headers (at minimum `Access-Control-Allow-Origin: *`) so the endpoint can be called from a browser."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Add an HTTP GET endpoint `GET /status` that returns a JSON object describing canister status (health) sufficient to debug whether logging is working (e.g., includes current time and reading counters such as `nextId` and the number of readings stored).",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-7"
        ],
        "quotes": [
          "we just want to return the status of the canister since data isnt being successfully logged stil"
        ]
      },
      "acceptanceCriteria": [
        "GET `https://<CANISTER_ID>.raw.icp0.io/status` returns HTTP 200 with a JSON body.",
        "The JSON includes a clear health indicator (e.g., `ok: true`) and includes fields that reflect the canisterâ€™s current logging state (e.g., `nextId` and a `readingsCount` derived from stored readings).",
        "When there are no readings yet, `/status` still returns 200 and shows counters consistent with an empty state (e.g., `nextId` is 0 and `readingsCount` is 0)."
      ]
    },
    {
      "id": "REQ-3",
      "text": "For unsupported paths/methods on the HTTP interface, return a JSON error response with an appropriate HTTP status code (e.g., 404 for unknown path, 405 for unsupported method).",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-4",
          "msg-7"
        ],
        "quotes": [
          "yes add one of the http endpoints now",
          "2. let's do simple /status"
        ]
      },
      "acceptanceCriteria": [
        "Requests to unknown paths on `https://<CANISTER_ID>.raw.icp0.io/...` return HTTP 404 with a JSON error body.",
        "Non-GET requests to `/status` return HTTP 405 (or equivalent) with a JSON error body."
      ]
    },
    {
      "id": "REQ-4",
      "text": "Update the frontend HTTP instructions UI to display the new `/status` endpoint URL (built from the resolved backend canister ID), including copy-to-clipboard and open-in-new-tab controls consistent with the existing endpoint rows.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-7"
        ],
        "quotes": [
          "2. let's do simple /status"
        ]
      },
      "acceptanceCriteria": [
        "When a backend canister ID is successfully resolved, the UI shows a `https://<CANISTER_ID>.raw.icp0.io/status` URL.",
        "The `/status` row includes a copy button that copies the exact URL and provides the same temporary 'Copied!' feedback behavior as other endpoints.",
        "The `/status` row includes an external-link button that opens the URL in a new tab."
      ]
    }
  ],
  "constraints": [
    "Backend must remain a single Motoko actor in `backend/main.mo`; do not introduce additional backend services.",
    "Do not modify any frontend files under `frontend/src/components/ui` or any paths listed as immutable in SYSTEM_CONTEXT."
  ],
  "nonGoals": [
    "Do not add unrelated new endpoints beyond `GET /status` in this change request.",
    "Do not implement third-party monitoring/alerting integrations.",
    "Do not redesign the overall UI beyond adding the new `/status` URL row."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}